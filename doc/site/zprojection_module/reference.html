
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../registration_module/reference.html">
      
      
        <link rel="next" href="../segmentation_module/reference.html">
      
      
      <link rel="icon" href="../logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Z-Projection module - VLabApp</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#z-projection-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="VLabApp" class="md-header__button md-logo" aria-label="VLabApp" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VLabApp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Z-Projection module
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="VLabApp" class="md-nav__button md-logo" aria-label="VLabApp" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    VLabApp
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../general/installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../general/tutorial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../general/files.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File naming conventions and supported formats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../registration_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Registration module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Z-Projection module
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="reference.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Z-Projection module
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    <span class="md-ellipsis">
      Input files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    <span class="md-ellipsis">
      Output files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-z-projection-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix: Z-Projection methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix: Z-Projection methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#z-projection" class="md-nav__link">
    <span class="md-ellipsis">
      Z-Projection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Z-Projection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#all-z-sections" class="md-nav__link">
    <span class="md-ellipsis">
      All Z sections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixed-range-of-z-sections" class="md-nav__link">
    <span class="md-ellipsis">
      Fixed range of Z sections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#range-of-z-sections-around-the-z-section-with-best-focus" class="md-nav__link">
    <span class="md-ellipsis">
      Range of Z sections around the Z section with best focus.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#z-section-with-best-focus" class="md-nav__link">
    <span class="md-ellipsis">
      Z section with best focus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../segmentation_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Segmentation module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cell_tracking_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cell tracking module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph_filtering_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Graph filtering module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../events_selection_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Events selection module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipeline_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pipeline module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../viewer_image_mask_graph_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    View image, mask and graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../viewer_registration_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    View registration matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../viewer_metadata_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    View metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../file_organization_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File organization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../file_conversion_mask_graph_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File conversion (masks and graphs)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../file_conversion_lossy_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File conversion (lossy preview)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image_cropping_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image cropping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ground_truth_generator_module/reference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ground truth generator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../general/plugins.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugins
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    <span class="md-ellipsis">
      Input files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    <span class="md-ellipsis">
      Output files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-z-projection-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix: Z-Projection methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix: Z-Projection methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#z-projection" class="md-nav__link">
    <span class="md-ellipsis">
      Z-Projection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Z-Projection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#all-z-sections" class="md-nav__link">
    <span class="md-ellipsis">
      All Z sections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixed-range-of-z-sections" class="md-nav__link">
    <span class="md-ellipsis">
      Fixed range of Z sections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#range-of-z-sections-around-the-z-section-with-best-focus" class="md-nav__link">
    <span class="md-ellipsis">
      Range of Z sections around the Z section with best focus.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#z-section-with-best-focus" class="md-nav__link">
    <span class="md-ellipsis">
      Z section with best focus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="z-projection-module">Z-Projection module</h1>
<p>The Z-Projection module performs a Z-stack projection of an image.</p>
<h2 id="input-files">Input files</h2>
<p>A list of multi-dimensional images with at least <code>X</code>, <code>Y</code>, and <code>Z</code> axes, and optionally <code>C</code> and <code>T</code> axes (see <a href="../general/files.html#images-and-masks">File formats - images and masks</a> for more information).</p>
<p>To populate the list, use the <kbd>Add file</kbd>, <kbd>Add folder</kbd> and <kbd>Remove selected</kbd> buttons to add images, folder (all images inside the folder) or remove images from the list. Alternatively, images and folder can be dragged and dropped from an external file manager.</p>
<p>When adding files or folders, only files satisfying all filters (click on <code>â–¶</code> above the list to show filters) are added to the list. By default, only files ending with one of the accepted file extensions (<code>.nd2</code>, <code>.tif</code>, <code>.tiff</code>, <code>.ome.tif</code>, <code>.ome.tiff</code>) are accepted.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt>Output folder</dt>
<dd>Either use each input image folder as output folder or specify a
custom output folder. To select a custom folder, either paste the path
into the text box, click on the <kbd>Browse</kbd> button, or drag and drop a
folder from an external file manager. Be careful when using a custom folder: if
two input files share the same filename (from different folders), the
output for both files will be written to the same output file,
resulting in data corruption.</dd>
<dt>Output suffix</dt>
<dd>The output filename will correspond to the input filename with an
additional <code>_vPR&lt;ref&gt;&lt;range&gt;&lt;proj&gt;</code> suffix, where <code>&lt;ref&gt;</code> is the reference Z-section (<code>b</code> for best focus or <code>f</code> for fixed range), <code>&lt;range&gt;</code> is the range of Z-sections (one integer for range around Z-section with best focus or two integers  min and max separated by a <code>-</code> for fixed Z-section range) and <code>&lt;proj&gt;</code> is the projection type (<code>none</code>, <code>max</code>, <code>min</code>, <code>mean</code>, <code>median</code> or <code>std</code>).  The resulting output filenames are shown below the suffix. It is not possible to set a user defined suffix in this module.</dd>
<dt>Projection range</dt>
<dd>
<p>Range of Z sections to project.</p>
<ul>
<li>Z-section with best focus: select only the Z-section with best focus.</li>
<li>Range around Z-section with best focus: select all Z sections with <span class="arithmatex">\(Z\)</span> in the interval <span class="arithmatex">\([Z_{best}-r,Z_{best}+r]\)</span>, where <span class="arithmatex">\(Z_{best}\)</span> is the Z section with best focus and <span class="arithmatex">\(r\)</span> is the range.</li>
<li>Fixed range from <span class="arithmatex">\(Z_{min}\)</span> to <span class="arithmatex">\(Z_{max}\)</span>: select all Z-sections with <span class="arithmatex">\(Z_{min}\leq Z \leq Z_{max}\)</span>.</li>
<li>All Z-sections: select all Z-sections.</li>
</ul>
<p>The selected Z-sections are then projected using the chosen projection type (see <a href="#appendix-z-projection-methods">Appendix: Z-Projection methods</a> for more information).</p>
</dd>
<dt>Projection type</dt>
<dd>summary statistics to use when projecting the selected Z-sections (<code>max</code>, <code>min</code>, <code>mean</code>, <code>median</code> or <code>std</code>). See <a href="#appendix-z-projection-methods">Appendix: Z-Projection methods</a> for more information.</dd>
<dt>Multi-processing</dt>
<dd>Number of processes to use for coarse-grain parallelization (memory
usage increases with the number of processes). This setting is only
useful if there are multiple input images, as each input image will be
assigned to its own process.</dd>
</dl>
<h2 id="output-files">Output files</h2>
<ul>
<li>Z-projected image (see <a href="../general/files.html#images-and-masks">File formats - images and masks</a> for more information).</li>
<li>Log file (see <a href="../general/files.html#log-files-and-metadata">File formats - Log files and metadata</a> for more information).</li>
</ul>
<p>Output filenames are obtained by adding a <code>_vPR&lt;ref&gt;&lt;range&gt;&lt;proj&gt;</code> suffix to the input filename. For example, with input image</p>
<pre><code>smp01_BF.nd2
</code></pre>
<p>and a mean projection over the fixed range from 3 to 7, the output Z-projected image and log file will have filenames:</p>
<pre><code>smp01_BF_vPRf3-7mean.ome.tif
smp01_BF_vPRf3-7mean.log
</code></pre>
<h2 id="appendix-z-projection-methods">Appendix: Z-Projection methods</h2>
<h3 id="z-projection">Z-Projection</h3>
<p>We consider the problem of reducing a Z-stack of 2D images to a unique 2D image (Z-projection).</p>
<p>The value <span class="arithmatex">\(v(x,y)\)</span> of the pixel at position <span class="arithmatex">\((x,y)\)</span> in the new image is obtained by summarizing the values of the pixels at the same position over all Z sections (or a subset of Z sections) using a given summary statistics (e.g. mean, median, max,...).</p>
<p>The subset of Z sections used for projection can be:</p>
<ul>
<li>all Z sections.</li>
<li>a fixed range of Z sections.</li>
<li>a range of Z sections around the Z section with best focus.</li>
<li>only the Z section with best focus.</li>
</ul>
<h4 id="all-z-sections">All Z sections</h4>
<p>All Z sections are used for the projection.</p>
<h4 id="fixed-range-of-z-sections">Fixed range of Z sections</h4>
<p>The subset of Z sections used for projection is chosen as all Z sections within the fixed interval <span class="arithmatex">\(Z\in[Z_\text{min},Z_\text{max}]\)</span>, with user-defined <span class="arithmatex">\(Z_\text{min}\)</span> and <span class="arithmatex">\(Z_\text{max}\)</span>.</p>
<p>Note:</p>
<ul>
<li><span class="arithmatex">\(Z_\text{min}\)</span> and <span class="arithmatex">\(Z_\text{max}\)</span> are called "From" and "To" in the GUI.</li>
</ul>
<h4 id="range-of-z-sections-around-the-z-section-with-best-focus">Range of Z sections around the Z section with best focus.</h4>
<p>The subset of Z sections used for projection is chosen as all Z sections within a user specified window around the Z section with best focus. I.e. Z sections with <span class="arithmatex">\(Z\in \{Z_\text{best}-\Delta_Z,Z_\text{best}-\Delta_Z +1,\cdots,Z_\text{best}+\Delta_Z\}\)</span>, where <span class="arithmatex">\(Z_\text{best}\)</span> corresponds to the Z-section with best focus and <span class="arithmatex">\(\Delta_Z\)</span> is the size of the Z window.</p>
<p>If <span class="arithmatex">\(Z_\text{best}\)</span> and <span class="arithmatex">\(\Delta_Z\)</span> are such that some values in <span class="arithmatex">\(\{Z_\text{best}-\Delta_Z,Z_\text{best}-\Delta_Z +1,\cdots,Z_\text{best}+\Delta_Z\}\)</span> are outside the range of Z sections existing in the image, then the set is shifted towards valid values of Z.
E.g. a Z-stack with 11 sections (Z=0, 1, ..., 10), <span class="arithmatex">\(\Delta_Z=3\)</span> and <span class="arithmatex">\(Z_\text{best}=1\)</span>: The set of Z sections to be used for projection is <span class="arithmatex">\(\{-2,-1,0,1,2,3,4\}\)</span>, which contains invalid values (-2 and -1). It is thus shifted in the positive Z direction to avoid negative values <span class="arithmatex">\(\{0,1,2,3,4,5,6\}\)</span> </p>
<p>To estimate <span class="arithmatex">\(Z_\text{best}\)</span> (see Figure 1 and 2), the tenengrad</p>
<div class="arithmatex">\[T(x,y) = \sqrt{\left(\frac{\partial v(x,y)}{\partial x}\right)^2 + \left(\frac{\partial v(x,y)}{\partial y}\right)^2}\]</div>
<p>of each Z section is estimated using Sobel operators of size 3x3. The tenengrad can be interpreted as a measure of the local slope. In particular, it is large for region of the image with sharp variations (such as edges) and zero for regions with constant pixel intensities.</p>
<p>The "sharpness" is then estimated, for each Z, as the variance of the tenengrad of the corresponding Z section (Figure 1C and 2C).
The sharpness is then smoothed using a running mean with window of size 3.
Finally, <span class="arithmatex">\(Z_\text{best}\)</span> is obtained as the <span class="arithmatex">\(Z\)</span> at which the smoothed sharpness reaches its maximum.</p>
<figure>
<a class="glightbox" href="images/sharpness_BF.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="images/sharpness_BF.png" alt="Terminology"/></a>
<figcaption>Figure 1: determination of Z section with best focus. Panel A: Z sections of a bright-field image. Panel B: Tenengrad of the Z sections. Panel C: Sharpness of each Z section (black points) as a function of Z together with the smoothed sharpness (blue).</figcaption>
</figure>

<figure>
<a class="glightbox" href="images/sharpness_Fluo.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="images/sharpness_Fluo.png" alt="Terminology"/></a>
<figcaption>Figure 2: same as Figure 1 but with a fluorescence image.</figcaption>
</figure>

<p>Note:</p>
<ul>
<li>The window size <span class="arithmatex">\(\Delta_Z\)</span> is called "Projection range" in the GUI.</li>
</ul>
<h4 id="z-section-with-best-focus">Z section with best focus</h4>
<p>The stack of Z sections is simply replaced by the Z section with best focus (obtained as described above).</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["search.suggest", "navigation.expand"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>